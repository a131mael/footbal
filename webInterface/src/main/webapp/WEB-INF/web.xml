<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0">
  <security-constraint>
    <web-resource-collection>
      <web-resource-name>JaxRsActivator</web-resource-name>
      <url-pattern>/*</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
      <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
  </security-constraint>
   <!-- SHIRO -->
    <filter>
        <filter-name>ShiroFilter</filter-name>
        <filter-class>org.apache.shiro.web.servlet.IniShiroFilter</filter-class>
        <init-param>
            <param-name>config</param-name>
            <param-value>
                [main]
                # For test can use dummy matcher
                myRealmCredentialsMatcher = org.apache.shiro.authc.credential.Md5CredentialsMatcher
                myRealmCredentialsMatcher.storedCredentialsHexEncoded = false
                
                #Cache
                #cacheManager = org.apache.shiro.cache.ehcache.EhCacheManager 
                #securityManager.cacheManager = $cacheManager 
                builtInCacheManager = org.apache.shiro.cache.MemoryConstrainedCacheManager
                securityManager.cacheManager = $builtInCacheManager

                # now define the realm, and specify that it use the above credentials matcher:
                myRealm = org.aaf.auth.Realm
                myRealm.credentialsMatcher = $myRealmCredentialsMatcher

                [filters]
                authc.loginUrl = /index.xhtml
                roles.unauthorizedUrl = /index.xhtml

                [urls]
                /pages/** = authc
            </param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>ShiroFilter</filter-name>
        <url-pattern>*.xhtml</url-pattern>
    </filter-mapping>
</web-app>